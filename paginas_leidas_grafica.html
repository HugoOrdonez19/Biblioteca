<!DOCTYPE html>
<html>
<head>
    <title>Páginas Leídas por Año</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
	<link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
</head>
<body>
    <canvas id="myChart"></canvas>
    <script>
        // Cargar datos desde el archivo JSON
        fetch('paginas_leidas_grafica.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log("Datos cargados correctamente:", data);

                // Procesar datos
				
                const labels = data.map(item => item['A\u00f1o de Lectura']);
                const totalPaginas = data.map(item => item['P\u00e1ginas Le\u00eddas Anuales']);
                const acumulados = data.map(item => item['Total Acumulado de P\u00e1ginas']);

                const ctx = document.getElementById('myChart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Páginas Leídas',
                                data: totalPaginas,
                                backgroundColor: 'rgba(92, 165, 147, 1)',
                                hoverBackgroundColor: 'rgba(45, 108, 104, 1)',
                                yAxisID: 'y',
								borderRadius:8,							
                            },
                            {
                                label: 'Total de Páginas Leídas',
                                data: acumulados,
                                type: 'line',
                                borderColor: 'rgba(28, 78, 96, 1)',
                                borderWidth: 2,
                                fill: false,
                                pointBackgroundColor: 'rgba(28, 78, 96, 1)',
								pointHoverRadius: 6,
								hoverBackgroundColor:'rgba(100, 183, 141, 1)',
                                tension: 0.5, // Redondear línea
                                yAxisID: 'y1',
                            },
                        ],
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'top',
								labels: {
									font: {
										size: 10, 
										family: 'Raleway',
									},
								},
                            },
                            title: {
                                display: true,
                                text: 'Páginas Leídas',
                                font: {
                                    size: 20,
                                    weight: 'bold',
									family: 'Raleway',
                                },
								align: 'start'
                            },
							subtitle: {
								display: true,
								text: 'Cantidad de páginas leídas cada año y total acumulado',
								font: {
									size: 14,
									family: 'Raleway',
									weight: 'normal',
								},
								padding: {
                                     bottom: 10,
									 top: 0
								},
								align:'start',
							},
                            datalabels: {
                                display: true,
                                color: 'black',
                                anchor: 'end',
                                align: 'top',
                                font: {
                                    family: 'Raleway',
                                    size: 11,
                                    weight: 'normal',
                                },
								formatter: (value) => value.toLocaleString(), // Formato con separadores de miles
                            },
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                position: 'left',
                                title: {
                                    display: true,
                                    text: 'Páginas Leídas',
                                    font: {
                                        family: 'Raleway',
                                        size: 12,
                                        weight: 'normal',
                                    },
                                },
								ticks: {
									font: {
										size: 10, // Reduce el tamaño de los números en el eje Y
									},
								},
								grid: {
                                    drawOnChartArea: false,
								},
								min: 0,
                                max: 25000,

                            },
                            y1: {
                                type: 'linear',
                                position: 'right',
                                title: {
                                    display: true,
                                    text: 'Total de Páginas Leídas',
                                    font: {
                                        family: 'Raleway',
                                        size: 12,
                                        weight: 'normal',
                                    },
                                },
                                grid: {
                                    drawOnChartArea: false,
                                },
								ticks: {
									font: {
										size: 10, // Reduce el tamaño de los números en el eje Y
									},
								},
								min: -10000,
                                max: 80000,

                            },
                            x: {
                                grid: {
                                    display: false, // Oculta las líneas verticales
                                },
                                ticks: {
                                    autoSkip: true,
                                    maxRotation: 45,
                                    minRotation: 0,
									font: {
										size: 10, // Reduce el tamaño de los números en el eje Y
									},
                                },
                                title: {
                                    display: true,
                                    text: 'Año de Lectura',
                                    font: {
                                        family: 'Raleway',
                                        size: 12,
                                        weight: 'normal',
                                    },
                                },
                            },
                        },
                    },
                    plugins: [ChartDataLabels], // Activar el plugin
                });
            })
            .catch(error => console.error('Error al cargar el archivo JSON:', error));
    </script>
</body>
</html>